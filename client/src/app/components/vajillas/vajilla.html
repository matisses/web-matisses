<matisses-header></matisses-header>

<!-- Modal editar -->
<div class="modal fade" id="modalEditar" tabindex="-1" role="dialog" aria-labelledby="modalEditarLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <form id="form_modal" #ModalForm="ngForm" (submit)="guardarVajilla(ModalForm)">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="refreshModal(ModalForm)"><span aria-hidden="true" class="icon-close"></span></button>
          <h4 class="modal-title text-center" id="modalEditar">Agregar nueva vajilla</h4>
        </div>
        <div class="row" *ngIf="messageError != null && messageError.length > 0">
          <div class="col-xs-12">
            <div class="alert alert-danger" role="alert">
              <p>{{messageError}}</p>
            </div>
          </div>
        </div>
        <div class="modal-body">
          <div class="container-fluid">
            <div class="row">
              <div class="col-xs-12">
                <div class="form-group">
                  <label for="name">Nombre*</label>
                  <input id="name" type="text" class="form-control" [class.required-field]="!valid" name="name" [(ngModel)]="vajilla.name" placeholder="ej: Vajilla Domo Gold 6 puestos" required>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="marca">Marca*</label>
                  <select id="marca" name="marca" class="form-control" [class.required-field]="!valid" [(ngModel)]="vajilla.brand" (change)="cargarColecciones()" required>
                    <option disabled selected value>Seleccione una</option>
                    <option [selected]="vajilla.brand == marca.code" *ngFor="let marca of marcas" [ngValue]="marca.code">{{marca.name}}</option>
                  </select>
                </div>
              </div>
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="collection">Colección*</label>
                  <select id="collection" name="collection" class="form-control" [class.required-field]="!valid" [(ngModel)]="vajilla.coleccion" (change)="cargarProductos()" required>
                    <option disabled selected value>Seleccione una</option>
                    <option [selected]="vajilla.coleccion == coleccion" *ngFor="let coleccion of colecciones" [ngValue]="coleccion">{{coleccion}}</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-6">
                <div class="form-group">
                  <label for="price">Precio:</label>
                  <input type="text" class="form-control" style="text-align: right" id="price" name="precio" [(ngModel)]="vajilla.priceTxt" readonly="readonly">
                </div>
              </div>
              <div class="col-sm-3">
                <div class="form-group">
                  <label for="ref">Referencias:</label>
                  <input type="text" class="form-control" style="text-align: right" id="ref" name="items" [(ngModel)]="vajilla.items" readonly="readonly">
                </div>
              </div>
              <div class="col-sm-3">
                <div class="form-group">
                  <label for="piece">Piezas:</label>
                  <input type="text" class="form-control" style="text-align: right" id="piece" name="pieces" [(ngModel)]="vajilla.pieces" readonly="readonly">
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-xs-12">
                <div class="table-responsive" *ngIf="itemsColeccion && itemsColeccion.length > 0">
                  <table class="table table-bordered table-striped">
                    <thead>
                      <tr>
                        <th>Referencia</th>
                        <th>Nombre</th>
                        <th>Cantidad</th>
                        <th>Precio</th>
                        <th>Valor total</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of itemsColeccion; let i = index">
                        <th><img src="https://img.matisses.co/{{item.itemcode}}/mini/{{item.itemcode}}_01.jpg" class="img-resposive" alt="">{{item.shortitemcode}}</th>
                        <td>{{item.itemname}}</td>
                        <td>
                          <div class="input-group grupo-cantidad">
                            <span class="input-group-addon span-cantidad" (click)="reducirCantidad(i)">
                              <button type="button" class="icon-minus btn-cantidad" name="button"></button>
                            </span>
                            <input class="input-cantidad form-control" type="tel" name="selectedQuantity_{{i}}" min="1" max="{{item.availablestock}}" [(ngModel)]="item.selectedQuantity" readonly/>
                            <span class="input-group-addon span-cantidad" (click)="aumentarCantidad(i)">
                              <button type="button" class="icon-plus btn-cantidad" name="button"></button>
                            </span>
                          </div>
                        </td>
                        <td>{{item.priceaftervat | number:0}}</td>
                        <td>{{item.priceaftervat * (!itemsColeccion[i].selectedQuantity ? 0 : itemsColeccion[i].selectedQuantity) | number:0}}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row" *ngIf="messageError != null && messageError.length > 0">
          <div class="col-xs-12">
            <div class="alert alert-danger" role="alert">
              <p>{{messageError}}</p>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <div class="container-fluid">
            <div class="row">
              <div class="col-xs-4">
                <div class="input-group">
                  <input id="shortitemcode" type="text" class="form-control" name="shortitemcode" [(ngModel)]="shortitemcode" placeholder="Agregar referencia">
                  <span class="input-group-btn">
                      <button type="button" class="btn btn-carrito" (click)="agregarReferencia(shortitemcode)">Agregar</button>
                    </span>
                </div>
              </div>
              <!-- <div class="col-xs-4">
                <div class="form-group">
                  <label for="exampleInputFile" class="btn-subir">Subir imagen</label>
                  <input type="file" id="exampleInputFile" class="custom-file-input">
                </div>
              </div> -->
              <div class="col-xs-4">
                <div class="input-group">
                  <button class="btn btn-carrito" type="submit" name="guardarVajilla">Crear</button>
                  <button class="btn btn-carrito" type="submit" name="editarVajilla">Editar</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal vajillas -->
<div class="modal fade" id="modalVajillas" tabindex="-1" role="dialog" aria-labelledby="modalVajillasLabel">
  <div class="modal-dialog modal-lg" role="document">
    <!-- <form class="" action="index.html" method="post"> -->
    <form id="form_modal_View" #ModalForm="ngForm">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="refreshModal(ModalForm)"><span aria-hidden="true" class="icon-close"></span></button>
          <h4 class="modal-title text-center" id="modalVajillas">{{vajilla.name}}</h4>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-sm-6 producto-modal" *ngFor="let item of vajilla.detail, let last = last" [ngClass]="{last : last}">
              <div class="row">
                <div class="col-sm-5 text-center">
                  <img src="https://img.matisses.co/{{item.itemcode}}/parrilla/{{item.itemcode}}_01.jpg" class="img-responsive" alt="">
                </div>
                <div class="col-sm-7">
                  <div class="info-modal">
                    <h1>{{item.itemname}}</h1>
                    <P class="referencia">Ref: {{item.shortitemcode}}</P>
                    <h4>$ {{item.priceaftervat | number:0}}</h4>
                    <p>Cantidad:</p>
                    <p>{{item.selectedQuantity}}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <div class="container-fluid">
            <div class="col-sm-5 col-xs-12 precio-vajilla">
              <h4>Precio total vajilla: ${{vajilla.price | number:0}}</h4>
            </div>
            <div class="col-sm-2 col-sm-offset-0 col-xs-8 col-xs-offset-2">
              <form>
                <div class="input-group">
                  <span class="input-group-addon span-cantidad" (click)="cambiarCantidadVajilla(-1)">
                  <button type="button" class="icon-minus btn-cantidad" name="button"></button>
                </span>
                  <input class="input-cantidad form-control" type="tel" name="selectedQuantity" min="1" max="{{totalStock}}" [(ngModel)]="cantidadSeleccionada" />
                  <span class="input-group-addon span-cantidad" (click)="cambiarCantidadVajilla(1)">
                  <button type="button" class="icon-plus btn-cantidad" name="button"></button>
                </span>
                </div>
              </form>
            </div>
            <div class="col-sm-5 col-xs-12 btn-agregar">
              <button type="button" class="btn btn-carrito" (click)="agregarCarrito()" data-dismiss="modal">Agregar al carrito</button>
            </div>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>

<div sticky-body>
  <div class="container-fluid padding-0">
    <div class="row">
      <div class="col-xs-12">
        <div id="carousel-vajillas" class="carousel slide" data-ride="carousel">
          <!-- Indicators -->
          <ol class="carousel-indicators">
            <li data-target="#carousel-vajillas" data-slide-to="0" class="active"></li>
            <li data-target="#carousel-vajillas" data-slide-to="1"></li>
            <li data-target="#carousel-vajillas" data-slide-to="2"></li>
          </ol>

          <!-- Wrapper for slides -->
          <div class="carousel-inner" role="listbox">

            <div class="item active">
              <img src="assets/images/vajillas/banner/01.png" class="img-responsive" alt="">
            </div>

            <div class="item">
              <img src="assets/images/vajillas/banner/02.png" class="img-responsive" alt="">
            </div>

            <div class="item">
              <img src="assets/images/vajillas/banner/03.png" class="img-responsive" alt="">
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
  <br/>
  <div class="container">
    <div class="row">
      <div class="col-md-4 text-center">
        <div class="mostrar">
          <div class="btn-group">
            <button type="button" class="btn btn-matisses dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                {{itemsXPag}} <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a (click)="cambiarTamanoPagina(12)">12 x pag</a></li>
              <li><a (click)="cambiarTamanoPagina(24)">24 x pag</a></li>
              <li><a (click)="cambiarTamanoPagina(36)">36 x pag</a></li>
              <li><a (click)="cambiarTamanoPagina(10000)">Todos</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-md-4 text-center">
        <div class="ordenar">
          <div class="btn-group">
            <button type="button" class="btn btn-matisses dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span [innerHTML]="orderByStr">
                    </span><span class="caret"></span>
                </button>
            <ul class="dropdown-menu" aria-labelledby="ordenar">
              <li><a (click)="orderByPrice(1)">Precio: más bajos primero</a></li>
              <li><a (click)="orderByPrice(-1)">Precio: más altos primero</a></li>
              <li><a (click)="changeOrder('itemname')">Nombre: de A a Z</a></li>
              <li><a (click)="changeOrder('-itemname')">Nombre: de Z a A</a></li>
              <li><a (click)="changeOrder('model')">Nuevos</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-md-4 text-center">
        <ul class="pagination">
          <li (click)="irAPagina(activePage - 1)">
            <a href="javascript:void(0)" aria-label="Previous">
                <span aria-hidden="true" class="glyphicon glyphicon-chevron-left"></span>
              </a>
          </li>
          <li><a href="javascript:void(0)" (click)="irAPagina(page)">{{page}}</a></li>
          <li (click)="irAPagina(activePage + 1)">
            <a href="javascript:void(0)" aria-label="Next">
                <span aria-hidden="true" class="glyphicon glyphicon-chevron-right"></span>
              </a>
          </li>
        </ul>
      </div>
    </div>
    <br/>
    <div class="row" *ngIf="messageExit != null && messageExit.length > 0">
      <div class="col-xs-12">
        <div class="alert alert-success" role="alert">
          <p>{{messageExit}}</p>
        </div>
      </div>
    </div>
    <div class="row hidden-sm hidden-xs" *ngIf="validToken">
      <div class="col-xs-12 text-center">
        <button type="button" class="btn-agregar-vajilla" data-toggle="modal" data-target="#modalEditar" (click)="vaciarMessage()">Agregar vajilla <span class="glyphicon glyphicon-plus"></span></button>
      </div>
    </div>
    <br/>
    <div class="row">
      <div class="col-sm-4 col-xs-6" *ngFor="let vajilla of vajillas">
        <div class="producto">
          <div class="row">
            <div class="col-xs-12">
              <p *ngIf="validToken">{{vajilla._id}}</p>
              <img src="https://img.matisses.co/vajillas/{{vajilla._id}}.jpg" class="img-responsive" alt="{{vajilla.name}}">
            </div>
          </div>
          <div class="info">
            <div class="row">
              <div class="col-xs-12 text-center">
                <p>{{vajilla.name}}</p>
                <button type="button" class="btn-coleccion" (click)="mostrarVajilla(vajilla)">Mostrar</button>
                <button type="button" class="btn-coleccion" (click)="editarVajilla(vajilla)" *ngIf="validToken">Editar</button>
                <!-- data-toggle="modal" data-target="#modalEditar" -->
                <button type="button" class="btn-coleccion" (click)="eliminarVajilla(vajilla)" *ngIf="validToken">Eliminar</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br/>
    <div class="row" *ngIf="messageExit != null && messageExit.length > 0">
      <div class="col-xs-12">
        <div class="alert alert-success" role="alert">
          <p>{{messageExit}}</p>
        </div>
      </div>
    </div>
  </div>
</div>

<matisses-carrito-simple #carritoSimple></matisses-carrito-simple>
<newsletter></newsletter>
<matisses-footer></matisses-footer>
